{% extends "layout.html" %}
{% block title %}Ajuste de Inventario{% endblock %}
{% block body %}
<main class="container" x-data>
  <h1>üßæ Ajuste de Inventario</h1>
  <p>Ingresa el saldo f√≠sico encontrado para cada ingrediente. El sistema calcular√° y aplicar√° autom√°ticamente los ajustes necesarios.</p>

  <form method="post">
    {% csrf_token %}
    <table>
      <thead>
        <tr>
          <th>Ingrediente</th>
          <th>Stock Actual</th>
          <th>Saldo Encontrado</th>
          <th>Diferencia</th>
          <th>Unidad</th>
        </tr>
      </thead>
      <tbody>
        {% for ing in ingredients %}
          <tr x-data="{ actual: {{ ing.stock_quantity }}, found: {{ ing.stock_quantity }}, get diff() { return (this.found - this.actual).toFixed(2); } }">
            <td>{{ ing.name }}</td>
            <td x-text="actual"></td>
            <td>
              <input type="number" step="0.01" name="found_{{ ing.id }}" x-model.number="found" required style="width: 6em;">
            </td>
            <td>
              <span :class="diff > 0 ? 'text-success' : diff < 0 ? 'text-error' : ''" x-text="diff"></span>
            </td>
            <td>{{ ing.unit }}</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>

    <footer style="margin-top: 1rem; display: flex; justify-content: space-between;">
      <a href="{% url 'inventory_list' %}" role="button" class="secondary">‚Üê Volver</a>
      <button type="submit">üíæ Guardar Ajustes</button>
    </footer>
  </form>
</main>

<style>
.text-success { color: green; font-weight: bold; }
.text-error { color: red; font-weight: bold; }
table { width: 100%; border-collapse: collapse; }
td, th { text-align: center; }
</style>
{% endblock %}
